{% extends 'base_template.html' %}
{% load leaflet_tags %}
{% load static %}


{% block title %} Soil Temperature Map {% endblock %}
{% block head_meta_page %}
    {% leaflet_js %}
    {% leaflet_css %}
{% endblock head_meta_page %}

{% block head_css_page %}
    <style xmlns="http://www.w3.org/1999/html">
        .leaflet-container { height: 100%; overflow: hidden}
        {#.leaflet-tile { border: solid black 2px; }#}
    </style>
    <link rel="stylesheet" type="text/css" href="{% static 'cgmap/style.css' %}">
{% endblock head_css_page %}

{% block footer_javascript_page %}
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    {# to get access from view in external js files #}
    {{grid_data|json_script:"grid_data"}}
    {{context|json_script:"context"}}
    {{cg_data|json_script:"cg_data"}}
    {{cell_data|json_script:"cell_data"}}
    <script src="{% static 'cgmap/basemap.js' %}"></script>
    <script src="{% static 'cgmap/datacharts.js' %}"></script>
    <script type="text/Javascript">
        function isSelected(){
            results = document.querySelector
        }
    </script>
{# jquery for scale animation #}
    <script>
        $('#depth-slider').on('click', function(){
            console.log( "Button depth-slider was clicked!" );
            $('#left-slider').toggleClass('depth-container-open');
            var icon = $('#depth_chevron');
            icon.toggleClass('left');
            if( icon.hasClass('left')){
                icon.text('chevron_left');
            } else {
                icon.text('chevron_right');
            }
        });

        $('#temperature-slider').on('click', function(){
            console.log( "Button temperature-slider was clicked!" );
            $('#right-slider').toggleClass('temperature-container-open');
            var icon = $('#temperature_chevron');
            icon.toggleClass('right');
            if( icon.hasClass('right')){
                icon.text('chevron_right');
            } else {
                icon.text('chevron_left');
            }
        });

        $('#close-btn').on('click', function(){
            console.log("container has been closed");
            document.getElementById('chart-container').style.display = "none";
        });

        function open_graph(){
            console.log("container has been opened");
            var div = document.getElementById('chart-container');
            if (div.style.display === "none") {
                div.style.display = "flex";
            } else {
                div.style.display = "none";
            }
        };
    </script>
{% endblock footer_javascript_page %}


{% block content %}
    <div id="map-wrapper">
        <div id="map">
            {% leaflet_map "main" %}
        </div>
 <!--       <div class="dialog-container">
            <div class="dialog-content">
                <div class="dialog-content-title header3">
                    {% for data in cg_data %}
                        {{ data.name }}
                    {% endfor %}
                </div>
                <div class="dialog-content-text default-text-small">
                    {% for data in cg_data %}
                       at the location with latitude {{ data.lat }} and longitude {{ data.long }}. </br>
                    {% endfor %}
                    With forcing data:
                    {% for forcing in fd_data%}
                        {{ forcing.name }}
                    {% endfor %}

                </div>
            </div>
        </div>-->
        <div class="depth-container left-transition" id="left-slider">
            <div class="depth-title-wrapper">
                <div class="description default-text-small">Depth in cm</div>
                <button class="btn btn-primary btn-sm" id="depth-slider" >
                    <span class="material-icons md-18 right" id="depth_chevron">chevron_right</span>
                </button>
            </div>
            <div class="scale-container">
                <div class="slider-container" id="depth">
                    <div class="scale-group-depth">
                        <form action=""method="get" id="load_data_form" style="margin-bottom: 8px;" onchange="changeData;" >
                            {% csrf_token %}
                            <input type="range" min="-14" max="0" step="1" value="0" class="slider" id="myRange">
                            <!--<div class="scale-element-group yellow">
                                <div class="rectangle opacity075" value="1" ></div>
                                <div class="rectangle opacity025" value="2"></div>
                                <div class="rectangle opacity015" value="3"></div>
                                <div class="rectangle opacity0" value="4"></div>
                            </div>
                            <div class="scale-element-group orange_brown">
                                <div class="rectangle opacity075"></div>
                                <div class="rectangle opacity05"></div>
                                <div class="rectangle opacity025"></div>
                                <div class="rectangle opacity015"></div>
                                <div class="rectangle opacity0"></div>
                            </div>
                            <div class="scale-element-group sand_brown">
                                <div class="rectangle opacity075"></div>
                                <div class="rectangle opacity05"></div>
                                <div class="rectangle opacity025"></div>
                                <div class="rectangle opacity015"></div>
                                <div class="rectangle opacity0"></div>
                            </div>
                            <div class="scale-element-group brown">
                                <div class="rectangle opacity075"></div>
                                <div class="rectangle opacity05"></div>
                                <div class="rectangle opacity025"></div>
                                <div class="rectangle opacity015"></div>
                                <div class="rectangle opacity0"></div>
                            </div>
                            <div class="scale-element-group dark_brown">
                                <div class="rectangle opacity075"></div>
                                <div class="rectangle opacity05"></div>
                                <div class="rectangle opacity025"></div>
                                <div class="rectangle opacity015"></div>
                                <div class="rectangle opacity0"></div>
                            </div>-->
                        </form>
                    </div>

                    <div class="scale-group-depth-text">
                        <span class="default-text-small">
                            1<br> 5<br> 10<br> 20<br> 50<br> 100<br> 200<br> 300<br> 400<br> 500<br> 600<br> 700<br>
                            800<br> 900<br> 1000 </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="chart-container" id="chart-container" style="display: none;">
            <canvas id="tempChart" width="600" height="400"></canvas>
            <button class="btn btn-primary btn-sm" type="button" id="close-btn" style="width: 18px;height: 18px;">
                <span class="material-icons md-18 close">close</span>
            </button>
        </div>
        <div class="temperature-container right-transition" id="right-slider">
            <div class="temperature-title-wrapper">
                <div class="description default-text-small">Temperature in Â°C</div>
                <button class="btn btn-primary btn-sm" id="temperature-slider">
                    <span class="material-icons md-18 left" id="temperature_chevron">chevron_left</span>
                </button>
            </div>
            <div class="scale-container">
                <div class="scale-group">
                    <div class="scale-element-group red">
                        <div class="rectangle opacity0"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity075"></div>
                    </div>
                    <div class="scale-element-group orange">
                        <div class="rectangle opacity0"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity075"></div>
                    </div>
                    <div class="scale-element-group yellow">
                        <div class="rectangle opacity0"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity075"></div>
                    </div>
                    <div class="scale-element-group green">
                        <div class="rectangle opacity0"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity075"></div>
                    </div>
                    <div class="scale-element-group blue">
                        <div class="rectangle opacity075"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity0"></div>
                    </div>
                    <!--<div class="scale-element-group purple">
                        <div class="rectangle opacity075"></div>
                        <div class="rectangle opacity05"></div>
                        <div class="rectangle opacity025"></div>
                        <div class="rectangle opacity015"></div>
                        <div class="rectangle opacity0"></div>
                    </div>-->
                </div>
                <div class="scale-group-text">
                    <span class="default-text-small" style="transform: rotate(90deg);">38<br> 36<br> 34<br> 32<br> 30<br> 28<br> 26<br> 24<br> 22<br> 20<br> 18<br> 16<br> 14<br> 12<br> 10<br> 8<br> 6<br> 4<br> 2<br> 0<br> -2<br> -4<br> -6<br> -8<br> -10 </span>
                </div>
            </div>
        </div>
        <div class="timeline-container">
            <div class="btn-group btn-group-toggle justify-content-start" id="timeline-nav" data-toggle="buttons">
                <label class="btn btn-secondary">
                    <input type="radio" name="options" id="previous" autocomplete="off" value="previous">
                    <span class="material-icons md-24">skip_previous</span>
                </label>
                <label class="btn btn-secondary">
                    <input type="radio" name="options" id="start" autocomplete="off" value="start">
                    <span class="material-icons md-24">play_arrow</span>
                </label>
                <label class="btn btn-secondary">
                    <input type="radio" name="options" id="next" autocomplete="off" value="next">
                    <span class="material-icons md-24">skip_next</span>
                </label>
            </div>
            <div class="timeline">
                <div class="timeline-group">
                    <div class="timeline-element" id="1-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-circle"></div>
                    </div>
                    <div class="timeline-element" id="2-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-circle"></div>
                    </div>
                    <div class="timeline-element" id="3-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-circle"></div>
                    </div>
                    <div class="timeline-element" id="4-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-circle"></div>
                    </div>
                    <div class="timeline-element" id="5-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-circle"></div>
                    </div>
                    <div class="timeline-element" id="6-timeline-element">
                        <div class="timeline-element-line"></div>
                        <div class="timeline-element-arrow"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}
